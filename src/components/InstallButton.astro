---
interface Props {
  packageName: string;
}

const { packageName } = Astro.props;
const command = `planmode install ${packageName}`;
---

<div class="group relative flex items-center bg-black-primary border border-grey-border/30 rounded-lg overflow-hidden">
  <code class="flex-1 px-4 py-3 text-sm font-mono text-grey-light select-all">
    {command}
  </code>
  <button
    class="copy-btn px-4 py-3 text-grey-text hover:text-white transition-colors border-l border-grey-border/30"
    data-command={command}
    aria-label="Copy install command"
  >
    <svg class="w-4 h-4 copy-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
    </svg>
    <svg class="w-4 h-4 check-icon hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
    </svg>
  </button>
</div>

<script>
  document.querySelectorAll(".copy-btn").forEach((btn) => {
    btn.addEventListener("click", async () => {
      const command = btn.getAttribute("data-command");
      if (!command) return;
      await navigator.clipboard.writeText(command);
      const copyIcon = btn.querySelector(".copy-icon") as HTMLElement;
      const checkIcon = btn.querySelector(".check-icon") as HTMLElement;
      copyIcon.classList.add("hidden");
      checkIcon.classList.remove("hidden");
      setTimeout(() => {
        copyIcon.classList.remove("hidden");
        checkIcon.classList.add("hidden");
      }, 2000);
    });
  });
</script>
